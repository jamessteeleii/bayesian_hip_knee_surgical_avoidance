time_period = factor(time)) |>
group_by(time_period, joint) |>
mutate(
dataset = "GMHBA members",
# joint = "Hip",
surv = cumprod(1-event/total),
surv_se = sqrt(((event/total) * (1 - event/total)) / total)
) |>
ungroup() |>
add_row(time_period = as.factor(0),
dataset = "GMHBA members",
joint = "Hip",
surv = 1,
surv_se = 0
) |>
add_row(time_period = as.factor(0),
dataset = "GMHBA members",
joint = "Knee",
surv = 1,
surv_se = 0
) |>
select(time_period, event, no_event, total, dataset, joint, surv, surv_se)
gmhba_data_summary <- data_gmhba_surgery |>
mutate(event = if_else(surgery == 1, "event", "no_event")) |>
group_by(time, joint) |>
count(event, .drop = FALSE) |>
filter(!is.na(joint)) |>
ungroup() |>
pivot_wider(names_from = event,
values_from = n) |>
mutate(event = case_when(
is.na(event) ~ 0,
.default = event
)) |>
mutate(total         = event + no_event,
time_period = factor(time)) |>
group_by(time_period, joint) |>
mutate(
dataset = "GMHBA members",
# joint = "Hip",
surv = cumprod(1-event/total),
surv_se = sqrt(((event/total) * (1 - event/total)) / total)
) |>
ungroup() |>
add_row(time_period = as.factor(0),
dataset = "GMHBA members",
joint = "Hip",
surv = 1,
surv_se = 0
) |>
add_row(time_period = as.factor(0),
dataset = "GMHBA members",
joint = "Knee",
surv = 1,
surv_se = 0
) |>
select(time_period, event, no_event, total, dataset, joint, surv, surv_se)
View(gmhba_data_summary)
data_gmhba_surgery |>
mutate(event = if_else(surgery == 1, "event", "no_event")) |>
group_by(time, joint) |>
count(event, .drop = FALSE) |>
filter(!is.na(joint)) |>
ungroup() |>
pivot_wider(names_from = event,
values_from = n) |>
mutate(event = case_when(
is.na(event) ~ 0,
.default = event
)) |>
mutate(total         = event + no_event,
time_period = factor(time)) |>
group_by(joint) |>
mutate(
dataset = "GMHBA members",
# joint = "Hip",
surv = cumprod(1-event/total),
surv_se = sqrt(((event/total) * (1 - event/total)) / total)
) |>
ungroup() |>
add_row(time_period = as.factor(0),
dataset = "GMHBA members",
joint = "Hip",
surv = 1,
surv_se = 0
) |>
add_row(time_period = as.factor(0),
dataset = "GMHBA members",
joint = "Knee",
surv = 1,
surv_se = 0
) |>
select(time_period, event, no_event, total, dataset, joint, surv, surv_se)
data_gmhba_surgery |>
mutate(event = if_else(surgery == 1, "event", "no_event")) |>
group_by(time, joint) |>
count(event, .drop = FALSE) |>
filter(!is.na(joint)) |>
ungroup() |>
pivot_wider(names_from = event,
values_from = n) |>
mutate(event = case_when(
is.na(event) ~ 0,
.default = event
)) |>
mutate(total         = event + no_event,
time_period = factor(time)) |>
group_by(joint) |>
mutate(
dataset = "GMHBA members",
# joint = "Hip",
surv = cumprod(1-event/total),
surv_se = sqrt(((event/total) * (1 - event/total)) / total)
)
gmhba_data_summary <- data_gmhba_surgery |>
mutate(event = if_else(surgery == 1, "event", "no_event")) |>
group_by(time, joint) |>
count(event, .drop = FALSE) |>
filter(!is.na(joint)) |>
ungroup() |>
pivot_wider(names_from = event,
values_from = n) |>
mutate(event = case_when(
is.na(event) ~ 0,
.default = event
)) |>
mutate(total         = event + no_event,
time_period = factor(time)) |>
group_by(joint) |>
mutate(
dataset = "GMHBA members",
# joint = "Hip",
surv = cumprod(1-event/total),
surv_se = sqrt(((event/total) * (1 - event/total)) / total)
) |>
ungroup() |>
add_row(time_period = as.factor(0),
dataset = "GMHBA members",
joint = "Hip",
surv = 1,
surv_se = 0
) |>
add_row(time_period = as.factor(0),
dataset = "GMHBA members",
joint = "Knee",
surv = 1,
surv_se = 0
) |>
select(time_period, event, no_event, total, dataset, joint, surv, surv_se)
targets::tar_make()
targets::tar_make()
install.packages("qs2")
targets::tar_make()
skou_data <- tibble(
time_period = as.factor(c(12,24)),
event = c(13,3),
no_event = c(37,34),
total = event + no_event
) |>
mutate(
dataset = "Skou et al. (2020)",
joint = "Knee",
surv = cumprod(1-event/total),
surv_se = sqrt(((event/total) * (1 - event/total)) / total)
) |>
add_row(time_period = as.factor(0),
dataset = "Skou et al. (2020)",
joint = "Knee",
surv = 1,
surv_se = 0
)
skou_data
# Gwynne-Jones et al., (2020) doi: 10.1016/j.arth.2020.04.087
# Follow up at mean 5.5 years for Joint Clinic non-surgical management
# Knee OA, baseline OKS 22.1
gwynne_jones_data <- tibble(
time_period = as.factor(66),
event = 42,
no_event = 122,
total = event + no_event
) |>
mutate(
dataset = "Gwynne-Jones et al. (2020)",
joint = "Knee",
surv = cumprod(1-event/total),
surv_se = sqrt(((event/total) * (1 - event/total)) / total)
) |>
add_row(time_period = as.factor(0),
dataset = "Gwynne-Jones et al. (2020)",
joint = "Knee",
surv = 1,
surv_se = 0
)
gwynne_jones_data
120-42
tibble(
time_period = as.factor(66),
event = 42,
no_event = 70,
total = event + no_event
) |>
mutate(
dataset = "Gwynne-Jones et al. (2020)",
joint = "Knee",
surv = cumprod(1-event/total),
surv_se = sqrt(((event/total) * (1 - event/total)) / total)
) |>
add_row(time_period = as.factor(0),
dataset = "Gwynne-Jones et al. (2020)",
joint = "Knee",
surv = 1,
surv_se = 0
)
tibble(
time_period = as.factor(c(12,24)),
event = c(13,3),
no_event = c(37,34),
total = event + no_event
) |>
mutate(
dataset = "Skou et al. (2020)",
joint = "Knee",
surv = cumprod(1-event/total),
surv_se = sqrt(((event/total) * (1 - event/total)) / total)
) |>
add_row(time_period = as.factor(0),
dataset = "Skou et al. (2020)",
joint = "Knee",
surv = 1,
surv_se = 0
)
97-52
tibble(
time_period = as.factor(66),
event = 52,
no_event = 45,
total = event + no_event
) |>
mutate(
dataset = "Gwynne-Jones et al. (2018)",
joint = "Hip",
surv = cumprod(1-event/total),
surv_se = sqrt(((event/total) * (1 - event/total)) / total)
) |>
add_row(time_period = as.factor(0),
dataset = "Gwynne-Jones et al. (2018)",
joint = "Hip",
surv = 1,
surv_se = 0
)
svege_exercise_time <- tibble(
time = c(4.594833262,
4.822495919,
6.784073006,
8.820928414,
9.802516575,
13.57351488,
14.85644478,
15.46095596,
16.74411432,
23.22913021,
27.98023167,
30.92202614,
32.95888155,
34.16664736,
35.37441318,
37.56216792,
43.89651294,
45.25506385,
47.29237618,
56.2659174,
61.62255811,
64.11599537)
) |>
mutate(time_period = case_when(
time < 12 ~ 12,
time < 24 ~ 24,
time < 36 ~ 36,
time < 48 ~ 48,
time < 60 ~ 60,
time < 72 ~ 72
)) |>
group_by(time_period) |>
count()
svege_exercise_time
svege_exercise_time <- tibble(
time = c(4.594833262,
4.822495919,
6.784073006,
8.820928414,
9.802516575,
13.57351488,
14.85644478,
15.46095596,
16.74411432,
23.22913021,
27.98023167,
30.92202614,
32.95888155,
34.16664736,
35.37441318,
37.56216792,
43.89651294,
45.25506385,
47.29237618,
56.2659174,
61.62255811,
64.11599537)
) |>
mutate(time_period = case_when(
time < 12 ~ 12,
time < 24 ~ 24,
time < 36 ~ 36,
time < 48 ~ 48,
time < 60 ~ 60,
time < 72 ~ 72
)) |>
group_by(time_period) |>
count()
svege_exercise_data <- tibble(
time_period = as.factor(c(12,24,36,48,60,72)),
event = svege_exercise_time$n,
total = c(55,50,42,39,27,11),
no_event = total - event
) |>
mutate(
dataset = "Svege et al. (2020) - Exercise + Education",
joint = "Hip",
surv = cumprod(1-event/total),
surv_se = sqrt(((event/total) * (1 - event/total)) / total)
) |>
relocate(total, .after = no_event)  |>
add_row(time_period = as.factor(0),
dataset = "Svege et al. (2020) - Exercise + Education",
joint = "Hip",
surv = 1,
surv_se = 0)
svege_exercise_data
svege_control_time <- tibble(
time = c(4.444048161,
4.97328102,
7.31182086,
7.614876067,
9.274882953,
9.427153059,
10.48401954,
11.39021515,
12.82415862,
13.73024,
14.0332952,
15.54251699,
16.14725663,
17.20412311,
18.11020449,
20.67515044,
24.82322573,
25.57863624,
30.9328781,
32.89456942,
35.76097135,
36.36559675,
36.89482961,
37.80102522,
41.27056755,
41.42295189,
43.30925066,
46.85418554,
49.87171526,
61.40906012,
63.22487827)
) |>
mutate(time_period = case_when(
time < 12 ~ 12,
time < 24 ~ 24,
time < 36 ~ 36,
time < 48 ~ 48,
time < 60 ~ 60,
time < 72 ~ 72
)) |>
group_by(time_period) |>
count()
svege_control_data <- tibble(
time_period = as.factor(c(12,24,36,48,60,72)),
event = svege_control_time$n,
total = c(54,44,36,30,21,5),
no_event = total - event
) |>
mutate(
dataset = "Svege et al. (2020) - Education Only",
joint = "Hip",
surv = cumprod(1-event/total),
surv_se = sqrt(((event/total) * (1 - event/total)) / total)
) |>
relocate(total, .after = no_event)  |>
add_row(time_period = as.factor(0),
dataset = "Svege et al. (2020) - Education Only",
joint = "Hip",
surv = 1,
surv_se = 0)
svege_control_data
gwynne_jones_data <- bind_rows(gwynne_jones_knee_data, gwynne_jones_data_hip)
# Gwynne-Jones et al., (2018) doi: 10.1016/j.arth.2018.04.011
# Follow up at 12 months for Joint Clinic non-surgical management
# Hip OA (Knee OA reported at 5 years in full below), baseline OHS 22.1
gwynne_jones_data_hip <- tibble(
time_period = as.factor(66),
event = 52,
no_event = 45,
total = event + no_event
) |>
mutate(
dataset = "Gwynne-Jones et al. (2018)",
joint = "Hip",
surv = cumprod(1-event/total),
surv_se = sqrt(((event/total) * (1 - event/total)) / total)
) |>
add_row(time_period = as.factor(0),
dataset = "Gwynne-Jones et al. (2018)",
joint = "Hip",
surv = 1,
surv_se = 0
)
# Gwynne-Jones et al., (2020) doi: 10.1016/j.arth.2020.04.087
# Follow up at mean 5.5 years for Joint Clinic non-surgical management
# Knee OA, baseline OKS 20.3
gwynne_jones_knee_data <- tibble(
time_period = as.factor(66),
event = 42,
no_event = 70,
total = event + no_event
) |>
mutate(
dataset = "Gwynne-Jones et al. (2020)",
joint = "Knee",
surv = cumprod(1-event/total),
surv_se = sqrt(((event/total) * (1 - event/total)) / total)
) |>
add_row(time_period = as.factor(0),
dataset = "Gwynne-Jones et al. (2020)",
joint = "Knee",
surv = 1,
surv_se = 0
)
gwynne_jones_data <- bind_rows(gwynne_jones_knee_data, gwynne_jones_data_hip)
gwynne_jones_data
# Gwynne-Jones et al., (2018) doi: 10.1016/j.arth.2018.04.011
# Follow up at 12 months for Joint Clinic non-surgical management
# Hip OA (Knee OA reported at 5 years in full below), baseline OHS 22.1
gwynne_jones_data_hip <- tibble(
time_period = as.factor(12),
event = 52,
no_event = 45,
total = event + no_event
) |>
mutate(
dataset = "Gwynne-Jones et al. (2018)",
joint = "Hip",
surv = cumprod(1-event/total),
surv_se = sqrt(((event/total) * (1 - event/total)) / total)
) |>
add_row(time_period = as.factor(0),
dataset = "Gwynne-Jones et al. (2018)",
joint = "Hip",
surv = 1,
surv_se = 0
)
# Gwynne-Jones et al., (2020) doi: 10.1016/j.arth.2020.04.087
# Follow up at mean 5.5 years for Joint Clinic non-surgical management
# Knee OA, baseline OKS 20.3
gwynne_jones_knee_data <- tibble(
time_period = as.factor(66),
event = 42,
no_event = 70,
total = event + no_event
) |>
mutate(
dataset = "Gwynne-Jones et al. (2020)",
joint = "Knee",
surv = cumprod(1-event/total),
surv_se = sqrt(((event/total) * (1 - event/total)) / total)
) |>
add_row(time_period = as.factor(0),
dataset = "Gwynne-Jones et al. (2020)",
joint = "Knee",
surv = 1,
surv_se = 0
)
gwynne_jones_data <- bind_rows(gwynne_jones_knee_data, gwynne_jones_data_hip)
gwynne_jones_data
datagrid(study = "pilot",
time_period = c("0", "12", "24", "36", "48", "60"),
intervention = c(0,1),
design = "single_arm")
library(brms)
library(marginaleffects)
datagrid(study = "pilot",
time_period = c("0", "12", "24", "36", "48", "60"),
intervention = c(0,1),
design = "single_arm")
test <- crossing(study = "pilot",
time_period = c("0", "12", "24", "36", "48", "60"),
intervention = c(0,1),
design = "single_arm")
test
test <- crossing(study = "pilot",
time_period = c("0", "12", "24", "36", "48", "60"),
intervention = c(0,1),
design = "single_arm") |>
mutate(draw = rnorm(n())) |>
pivot_wider(names_from = intervention,
values_from = draw)
test
